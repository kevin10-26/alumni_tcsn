<dialog id="report-modal"
  class="fixed inset-0 w-full h-screen bg-black/60 bg-opacity-50 flex justify-center items-center justify-center z-50 hidden">
  <div class="mx-auto bg-white w-full max-w-3xl rounded-2xl shadow-lg overflow-hidden transform scale-95 transition-transform duration-200">
    
    <div class="flex justify-between items-center px-6 py-4 border-b border-gray-200">
      <h2 class="text-xl font-semibold text-gray-800">
        Détails du signalement
      </h2>
      <button id="close-report-modal" class="text-gray-500 hover:text-gray-800 text-2xl leading-none">
        &times;
      </button>
    </div>

    <div class="p-6 space-y-6 overflow-y-auto max-h-[80vh]">

      <div>
        <h3 class="text-lg font-semibold text-gray-800">{{ report.topic }}</h3>
        <p class="text-sm text-gray-500">
          Type : <span class="font-medium">{{ report.type }}</span>
        </p>
      </div>

      <div class="bg-gray-50 border border-gray-200 rounded-xl p-4">
        <h4 class="text-md font-semibold text-gray-700 mb-2">Contenu signalé</h4>

        {% if report.type == 'user' %}
          <p class="text-gray-700">
            Utilisateur : <span class="font-medium">{{ report.target.username }}</span><br>
            Statut : {{ report.target.status }}<br>
            Email : {{ report.target.emailAddress.value }}
          </p>

        {% elseif report.type == 'post' %}
          <p class="text-gray-700 mb-2">
            Publication de <span class="font-medium">{{ report.target.author.username }}</span>
            dans <span class="italic">{{ report.target.channel.name }}</span>
          </p>
          <blockquote class="border-l-4 border-gray-400 pl-3 italic text-gray-600 bg-white rounded p-2">
            {{ report.target.content }}
          </blockquote>
          <p class="text-sm text-gray-500 mt-1">Publié le {{ report.target.createdAt|date('d/m/Y H:i') }}</p>

        {% elseif report.type == 'channel' %}
          <p class="text-gray-700 mb-1">
            Channel : <span class="font-medium">{{ report.target.name }}</span>
          </p>
          <p class="text-gray-600">{{ report.target.description }}</p>
          <p class="text-sm text-gray-500 mt-1">Fondé par {{ report.target.founder.username }}</p>

        {% elseif report.type == 'jobOffer' %}
          <p class="text-gray-700">
            Offre : <span class="font-medium">{{ report.target.jobName }}</span><br>
            Entreprise : {{ report.target.company.name }}<br>
            Type : {{ report.target.jobType }}<br>
            Auteur : {{ report.target.author.username }}
          </p>
          <div class="mt-2 border-l-4 border-blue-300 bg-white p-3 rounded text-gray-700">
            {{ report.target.description }}
          </div>
        {% else %}
          <p class="text-gray-500 italic">Aucun contenu associé à ce signalement.</p>
        {% endif %}
      </div>

      <div>
        <h4 class="text-md font-semibold text-gray-700 mb-2">Description du signalement</h4>
        <div class="bg-gray-50 rounded-lg p-4 border border-gray-200 text-gray-700 whitespace-pre-line">
          {{ report.description }}
        </div>
      </div>

      <div>
        <span class="
          inline-block px-3 py-1 rounded-full text-sm font-medium
          {{ report.status == 'resolved' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800' }}
        ">
          {{ report.status == 'resolved' ? 'Résolu' : 'Non résolu' }}
        </span>
      </div>

      <div>
        <p class="font-medium text-gray-700 mb-1">Pièces jointes :</p>
        {% if report.attachments|length > 0 %}
          <ul class="list-disc pl-5 text-sm text-blue-600">
            {% for file in report.attachments %}
              <li>
                <a href="{{ file.url }}" target="_blank" class="hover:underline">
                  {{ file.filename }}
                </a>
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <p class="text-sm text-gray-500">Aucune pièce jointe.</p>
        {% endif %}
      </div>

      <div class="text-sm text-gray-600 border-t border-gray-200 pt-4">
        Signalé par <span class="font-medium text-gray-800">{{ report.author.username }}</span><br>
        Créé le {{ report.createdAt|date('d/m/Y H:i') }} — Mis à jour le {{ report.updatedAt|date('d/m/Y H:i') }}
      </div>
    </div>

    <form class="ml-4" action="#">
        <label for="report-reason">Justification</label><br />
        <textarea name="report-reason" id="report-reason" class="p-4 border-2 border-solid border-stone-800"></textarea>
    </form>

    <div class="px-6 py-4 border-t border-gray-200 flex flex-col sm:flex-row sm:justify-end gap-3 bg-gray-50">
      <button
        class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition"
        onclick="deleteReportedContent('{{ report.id }}', '{{ report.type }}');">
        Supprimer le contenu signalé
      </button>

      <button
        class="px-4 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400 transition"
        onclick="disclaimReportedContent('{{ report.id }}', '{{ report.type }}');">
        Laisser couler
      </button>
    </div>

  </div>
</dialog>
